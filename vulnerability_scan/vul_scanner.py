import port_scanner

targets_ip = input('Enter target to scan for available ports: ')

port1 = int(input('Enter the first port of the range to be scanned: '))
port2 = int(input('Enter the last port of the range to be scanned: '))

vul_file =  input('Enter the path to the file with vulnerable software: ')

target = port_scanner.PortScan(targets_ip, port1, port2)

target.scan()


# iterate through found banners and compare them to the known vulnerabilities from our text file. 
with open(vul_file, 'r') as file:
    
    for count, banner in enumerate(target.banner_list):
        file.seek(0)
        print(banner)
        
        for line in file.readlines:
            if line.strip() in banner:
                print(f'[!!!] VULNERABLE BANNER {banner} ON PORT {str(target.open_ports[count])}')
        